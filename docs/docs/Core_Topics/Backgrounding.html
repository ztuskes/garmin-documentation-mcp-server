<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2025"><meta name="DC.rights.owner" content="(C) Copyright 2025"><meta name="DC.type" content="topic"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="background-services"><link rel="stylesheet" type="text/css" href="../../branding/commonltr.css"><link rel="stylesheet" type="text/css" href="../../branding/style.css"><title>Background Services</title></head><body id="background-services"><header role="banner"><div>
<link href="../../resources/programmers-guide/google-code-prettify/prettify.css" type="text/css" rel="stylesheet">
<script src="../../resources/programmers-guide/jquery-1.11.3.min.js"></script>
<script>
    $(document).ready( function() {
        $( 'pre' ).addClass( 'prettyprint' );
    } );
</script>
<script src="../../resources/programmers-guide/google-code-prettify/run_prettify.js"></script>
</div></header><nav role="toc"><ul><li><a href="../../docs/Readme/Intro.html">Introduction</a></li><li><a href="../../docs/Connect_IQ_Basics/Welcome_to_the_Jungle.html">Welcome to Connect IQ</a></li><li><a href="../../docs/Monkey_C/Basic_Syntax.html">Hello Monkey C!</a></li><li><a href="../../docs/Core_Topics/Overview.html">Core Topics</a><ul><li><a href="../../docs/Core_Topics/Manifest_and_Permissions.html">Manifest File and Permissions</a></li><li><a href="../../docs/Core_Topics/Application_and_System_Modules.html">Application and System Modules</a></li><li><a href="../../docs/Core_Topics/Persisting_Data.html">Persisting Data</a></li><li class="active"><a href="../../docs/Core_Topics/Backgrounding.html">Background Services</a></li><li><a href="../../docs/Core_Topics/Glances.html">Glances</a></li><li><a href="../../docs/Core_Topics/Properties_and_App_Settings.html">Properties and Settings</a></li><li><a href="../../docs/Core_Topics/Intents.html">Intents</a></li><li><a href="../../docs/Core_Topics/Notifications.html">Notifications</a></li><li><a href="../../docs/Core_Topics/Build_Configuration.html">Build Configuration</a></li><li><a href="../../docs/Core_Topics/Security.html">Security</a></li><li><a href="../../docs/Core_Topics/User_Interface.html">Views, Drawables and Layers</a></li><li><a href="../../docs/Core_Topics/Layouts.html">Layouts</a></li><li><a href="../../docs/Core_Topics/Graphics.html">Graphics</a></li><li><a href="../../docs/Core_Topics/Input_Handling.html">Input Handling</a></li><li><a href="../../docs/Core_Topics/Native_Controls.html">Native UI Controls</a></li><li><a href="../../docs/Core_Topics/Resources.html">Resources</a></li><li><a href="../../docs/Core_Topics/Monkey_Style.html">Monkey Style</a></li><li><a href="../../docs/Core_Topics/Getting_the_Users_Attention.html">Getting the User's Attention</a></li><li><a href="../../docs/Core_Topics/Editing_Watch_Faces_On_Device.html">Watch Face Configurations</a></li><li><a href="../../docs/Core_Topics/HTTPS.html">JSON REST Requests</a></li><li><a href="../../docs/Core_Topics/Authenticated_Web_Services.html">Authenticated Web Services</a></li><li><a href="../../docs/Core_Topics/Communicating_with_Mobile_Apps.html">Communicating with Mobile Apps</a></li><li><a href="../../docs/Core_Topics/Downloading_Content.html">Downloading Content</a></li><li><a href="../../docs/Core_Topics/Mobile_SDK_for_Android.html">Mobile SDK for Android</a></li><li><a href="../../docs/Core_Topics/Mobile_SDK_for_iOS.html">Mobile SDK for iOS</a></li><li><a href="../../docs/Core_Topics/Ant_and_Ant_Plus.html">ANT and ANT+</a></li><li><a href="../../docs/Core_Topics/Bluetooth_Low_Energy.html">Getting Started with Connect IQ BLE Development</a></li><li><a href="../../docs/Core_Topics/Pairing_Wireless_Devices.html">Sensor Pairing</a></li><li><a href="../../docs/Core_Topics/Sensors.html">Sensors</a></li><li><a href="../../docs/Core_Topics/Positioning.html">Positioning</a></li><li><a href="../../docs/Core_Topics/Activity_Recording.html">Activity Recording</a></li><li><a href="../../docs/Core_Topics/Quantifying_the_User.html">Quantifying User Information</a></li><li><a href="../../docs/Core_Topics/Complications.html">Complications</a></li><li><a href="../../docs/Core_Topics/Shareable_Libraries.html">Shareable Libraries</a></li><li><a href="../../docs/Core_Topics/Debugging.html">Testing and Debugging</a></li><li><a href="../../docs/Core_Topics/Unit_Testing.html">Unit Testing</a></li><li><a href="../../docs/Core_Topics/Exception_Reporting_Tool.html">Error Reporting Application (ERA)</a></li><li><a href="../../docs/Core_Topics/Profiling.html">Profiling Applications</a></li><li><a href="../../docs/Core_Topics/Publishing_to_the_Store.html">Publishing to the Connect IQ Store</a></li><li><a href="../../docs/Core_Topics/Beta_Apps.html">Beta Apps</a></li><li><a href="../../docs/Core_Topics/Trial_Apps.html">App Trials</a></li><li><a href="../../docs/Core_Topics/Requesting_Reviews.html">Requesting Reviews</a></li></ul></li><li><a href="../../docs/User_Experience_Guidelines/Overview.html">User Experience Guidelines</a></li><li><a href="../../docs/Personality_Library/Personality_UI.html">Personality UI</a></li><li><a href="../../docs/Connect_IQ_FAQ/Overview.html">Connect IQ FAQ</a></li><li><a href="../../docs/Reference_Guides/Overview.html">Reference Guides</a></li><li><a href="../../docs/App_Review_Guidelines/Overview.html">Garmin Connect IQ App Review Guidelines</a></li><li><a href="../../docs/Monetization/Overview.html">Connect IQ Monetization System</a></li><li><a href="../../docs/Device_Reference/Overview.html">Device Reference</a></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">Background Services</h1><div class="body"><p class="p"><em class="ph i">Since API level 2.3.0</em></p><p class="p">Applications can register for background services. Services can be registered to run when various events occur. These events include when the user reaches goal targets, when sleep and wake times occur, when a steps threshold is reached, or at a scheduled time. Modules available to background processes differ from those of their parent application.</p><p class="p">Services may be terminated at any time free memory for foreground applications. Services will also be terminated automatically if the do not exit properly within 30 seconds of opening.</p></div><article class="topic nested1" aria-labelledby="ariaid-title2" id="registering-for-events"><h2 class="title topictitle2" id="ariaid-title2">Registering for Events</h2><div class="body"><p class="p">When your application runs you can register for events your application can subscribe to by using calls in the <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html" target="_blank">Toybox.Background</a> module.</p><table class="table"><caption></caption><colgroup><col><col><col><col></colgroup><thead class="thead"><tr class="row"><th class="entry align-left" id="registering-for-events__entry__1">Event</th><th class="entry align-left" id="registering-for-events__entry__2">Description</th><th class="entry align-left" id="registering-for-events__entry__3">Register With</th><th class="entry align-left" id="registering-for-events__entry__4">API Level</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Activity Completed</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service when the user completes an activity</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForActivityCompletedEvent-instance_function" target="_blank">Background.registerForActivityCompletedEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">3.1.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Goal</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service when the user meets one of their activity goals</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForGoalEvent-instance_function" target="_blank">Background.registerForGoalEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">2.3.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">OAUTH Response</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service when the user completes the OAUTH flow</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForOAuthResponseEvent-instance_function" target="_blank">Background.registerForOAuthResponseEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">2.3.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Phone App Message</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service when your app receives a message from the Mobile SDK</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForPhoneAppMessageEvent-instance_function" target="_blank">Background.registerForPhoneAppMessageEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">3.2.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Sleep</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service at the time the user has configured as their sleep time</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForSleepEvent-instance_function" target="_blank">Background.registerForSleepEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">2.3.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Steps</td><td class="entry align-left" headers="registering-for-events__entry__2">Wakes your background service every 1000 steps taken by the user</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForStepsEvent-instance_function" target="_blank">Background.registerForStepsEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">2.3.0</td></tr><tr class="row"><td class="entry align-left" headers="registering-for-events__entry__1">Temporal</td><td class="entry align-left" headers="registering-for-events__entry__2">Allows your service to be woken at a specific time or repeatedly at a certain interval (up to every five minutes)</td><td class="entry align-left" headers="registering-for-events__entry__3"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#registerForTemporalEvent-instance_function" target="_blank">Background.registerForTemporalEvent()</a></td><td class="entry align-left" headers="registering-for-events__entry__4">2.3.0</td></tr></tbody></table></div></article><article class="topic nested1" aria-labelledby="ariaid-title3" id="making-a-servicedelegate"><h2 class="title topictitle2" id="ariaid-title3">Making a <code class="ph codeph">ServiceDelegate</code></h2><div class="body"><p class="p">When background services are started, the <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Application/AppBase.html#getServiceDelegate-instance_function" target="_blank">AppBase.getServiceDelegate()</a> is called. This method returns a <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/System/ServiceDelegate.html" target="_blank">System.ServiceDelegate</a> and the method corresponding to the event that triggered is invoked. Once a background service has finished any necessary tasks, it should exit using the <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Background.html#exit-instance_function" target="_blank">Background.exit()</a> method. This method takes a argument containing data to be sent to the main process. Use null to provide no data.</p></div><article class="topic nested2" aria-labelledby="ariaid-title4" id="application-scope"><h3 class="title topictitle3" id="ariaid-title4">Application Scope</h3><div class="body"><p class="p">Background services are allowed to run at any time, including while the user is in an activity. In order to achieve this, the memory pool made available to background services is much smaller than what is available for the application. In many instances, the executable code of your application will be larger than the memory pool available.</p><p class="p">The Connect IQ compiler allows you to select what code is necessary for running in the background with the <code class="ph codeph">:background</code> annotation. Only modules, classes, functions and member variables decorated with the <code class="ph codeph">:background</code> annotation will be compiled into your background service. This means you must decorate all related code with the annotation (including your Application class).</p><pre class="pre codeblock typescript"><code>import Toybox.Application;
import Toybox.Background;
import Toybox.System;
import Toybox.Time;

// Because this is referenced in the application object
// constructor, it must be marked as background.
(:background)
var globalMember;

// Your application object has to be marked as background
// so that the service delegate can be referenced
(:background)
class MyApp extends Application.AppBase {

    // Constructor. Remember everything referenced in this function
    // must be marked as background
    public function initialize() {
        // Register to run every five minutes
        if(Background.getTemporalEventRegisteredTime() != null) {
            Background.registerForTemporalEvent(new Time.Duration(5 * 60))
        }
        // Initialize a global member
        $.globalMember = true;
    }

    public function getServiceDelegate() as [System.ServiceDelegate] {
        return [new MyServiceDelegate()];
    }

}

// Your service delegate has to be marked as background
// so it can handle your service callbacks
(:background)
class MyServiceDelegate extends System.ServiceDelegate {

    public function onTemporalEvent() as Void {
        // Do fun stuff here
    }

}</code></pre><p class="p">If your type check level is at <code class="ph codeph">gradual</code> or above, the compiler will detect if your background service or any objects referenced is attempting to reference something not marked as background. See <a class="xref" href="../Monkey_C/Monkey_Types.html#monkeytypes">Monkey Types</a> for more information.</p><p class="p">The resource compiler can control the scope level of your resources as well. See the <a class="xref" href="Resources.html#resourcescope">Resources</a> section for more information.</p></div></article></article><article class="topic nested1" aria-labelledby="ariaid-title5" id="simulating-background-services"><h2 class="title topictitle2" id="ariaid-title5">Simulating Background Services</h2><div class="body"><p class="p">In the Connect IQ simulator, an option has been added under the Simulation menu, which allows manually triggering background services. When manually triggering a service, the background service for the most recently run application will be loaded, and the corresponding call in the <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/System/ServiceDelegate.html" target="_blank">System.ServiceDelegate</a> will be triggered regardless of whether the application has registered for that event.</p></div></article></article></main><footer role="contentinfo"><div>
<p class="disclaimer">
Connect IQ System None API 8.2.3 Documentation. Copyright 2025 Garmin International. All Rights Reserved.
</p>
</div></footer></body></html>