<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2025"><meta name="DC.rights.owner" content="(C) Copyright 2025"><meta name="DC.type" content="topic"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="how-do-i-create-an-audio-content-provider"><link rel="stylesheet" type="text/css" href="../../branding/commonltr.css"><link rel="stylesheet" type="text/css" href="../../branding/style.css"><title>How do I create an Audio Content Provider?</title></head><body id="how-do-i-create-an-audio-content-provider"><header role="banner"><div>
<link href="../../resources/programmers-guide/google-code-prettify/prettify.css" type="text/css" rel="stylesheet">
<script src="../../resources/programmers-guide/jquery-1.11.3.min.js"></script>
<script>
    $(document).ready( function() {
        $( 'pre' ).addClass( 'prettyprint' );
    } );
</script>
<script src="../../resources/programmers-guide/google-code-prettify/run_prettify.js"></script>
</div></header><nav role="toc"><ul><li><a href="../../docs/Readme/Intro.html">Introduction</a></li><li><a href="../../docs/Connect_IQ_Basics/Welcome_to_the_Jungle.html">Welcome to Connect IQ</a></li><li><a href="../../docs/Monkey_C/Basic_Syntax.html">Hello Monkey C!</a></li><li><a href="../../docs/Core_Topics/Overview.html">Core Topics</a></li><li><a href="../../docs/User_Experience_Guidelines/Overview.html">User Experience Guidelines</a></li><li><a href="../../docs/Personality_Library/Personality_UI.html">Personality UI</a></li><li><a href="../../docs/Connect_IQ_FAQ/Overview.html">Connect IQ FAQ</a><ul><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Get_My_Watch_Face_to_Update_Every_Second.html">How do I Make My Watch Face Update Every Second?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Use_REST_Services.html">How do I communicate with REST services?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Make_a_Watch_Face_for_AMOLED_Products.html">How do I Make a Watch Face for AMOLED Products?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Create_a_Connect_IQ_Background_Service.html">How do I create a Connect IQ Background Service?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Optimize_Bitmaps.html">How do I optimize bitmaps in my app?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Override_the_Goal_Animations.html">How do I Override The Goal Animation?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Use_Custom_Fonts.html">How do I use custom fonts?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Use_a_Mapview.html">How do I use a MapView?</a></li><li><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Use_the_Connect_IQ_Mobile_SDK.html">How do I use the Connect IQ Mobile SDK</a></li><li class="active"><a href="../../docs/Connect_IQ_FAQ/How_Do_I_Create_an_Audio_Content_Provider.html">How do I create an Audio Content Provider?</a></li></ul></li><li><a href="../../docs/Reference_Guides/Overview.html">Reference Guides</a></li><li><a href="../../docs/App_Review_Guidelines/Overview.html">Garmin Connect IQ App Review Guidelines</a></li><li><a href="../../docs/Monetization/Overview.html">Connect IQ Monetization System</a></li><li><a href="../../docs/Device_Reference/Overview.html">Device Reference</a></li></ul></nav><main role="main"><article role="article" aria-labelledby="ariaid-title1"><h1 class="title topictitle1" id="ariaid-title1">How do I create an Audio Content Provider?</h1><div class="body"><p class="p">In 2018 Garmin has launched <a class="xref" href="https://buy.garmin.com/en-US/US/c10002-p1.html?FILTER_FEATURE_MUSICSTORAGE=true&amp;sorter=featuredProducts-desc" target="_blank">multiple music capable wearable products</a> that allow users to leave their phone at home while they live their active lifestyle. Users can copy their music library directly to the device, or they can install a Connect IQ audio content provider app that acts as a bridge between the wearable and a Content Delivery Network (CDN).</p><p class="p"><em class="ph i">Audio content providers</em> enable third-party music services to deliver protected content. They can download content from a CDN via Wi-Fi directly to the watch, and act as a plug-in to the native media player. The content is encrypted before it reaches disk and decrypted during playback.</p><p class="p">This post explains all the roles an audio content provider fills as well as the basics of implementation.</p></div><article class="topic nested1" aria-labelledby="ariaid-title2" id="syncing-content-to-the-device"><h2 class="title topictitle2" id="ariaid-title2">Syncing Content to the Device</h2><div class="body"><p class="p">The Garmin music wearables interact with third party services by syncing content to the device for later playback. Users can launch the music app in a <em class="ph i">sync configuration</em> state that lets them select what content they want to sync down to the device.</p><figure class="fig fignone">
<img class="image" src="../../resources/faq/sync_config.png"><br>
</figure><p class="p">The sync configuration user interface is defined by the audio content provider app. If you want your interface to be consistent with the device look and feel, the WatchUi.Menu2 class will do much of your implementation for you. If you want to tailor your look and feel to your brand, the <code class="ph codeph">WatchUi.CustomMenu</code> provides much more flexibility.</p><p class="p">Audio content provider apps can download content from a content delivery network via restful services directly to the watch. To get a song onto the watch the following should occur:</p><ol class="ol"><li class="li"><p class="p">The Connect IQ app uses a web API to request an audio file download</p></li><li class="li"><p class="p">The back-end service will serve up the audio file from the CDN</p></li><li class="li"><p class="p">The Connect IQ app will store the downloaded audio file on the watch's file system. As the data is written to the filesystem the content is encrypted; no un-encrypted content ever gets written to the filesystem.</p></li></ol><figure class="fig fignone">
<img class="image" src="../../resources/faq/downloading_music_content.png"><br>
</figure><p class="p">Content downloaded by audio content provider apps are protected in several ways:</p><ol class="ol"><li class="li"><p class="p">Music apps and audio files stored in hidden folders on device</p></li><li class="li"><p class="p">Apps and audio files are encrypted using AES-128.</p></li><li class="li"><p class="p">App can destroy all downloaded and reset encryption key in a single call</p></li></ol><p class="p">Each application gets access to a storage sandbox. The storage files are encrypted and cannot be accessed by any other apps on the system.</p><p class="p">The system will initiate a sync after the configuration step. The user will be prompted to start a sync, and if they agree the device will activate Wi-Fi, and upon connection the system will request the app create a <code class="ph codeph">SyncDelegate</code>. The delegate is used to notify the app that a sync has started, has been stopped, and to determine if a sync is needed. In the <code class="ph codeph">onStart</code> method of the <code class="ph codeph">SyncDelegate</code>, the app needs to download the songs chosen in the sync configuration step. The app notifies the system of the sync progress, so the UI can be updated.</p><figure class="fig fignone">
<img class="image" src="../../resources/faq/sync_flow.png"><br>
</figure></div></article><article class="topic nested1" aria-labelledby="ariaid-title3" id="playback"><h2 class="title topictitle2" id="ariaid-title3">Playback</h2><div class="body"><p class="p">Once the content is downloaded, the Connect IQ app can serve up the audio files to the native media player for playback. They can either use the media controls to control playback, or the user can select what content they want to listen to by entering the playback configuration mode of the app.</p><figure class="fig fignone">
<img class="image" src="../../resources/faq/playback_tree.png"><br>
</figure></div><article class="topic nested2" aria-labelledby="ariaid-title4" id="playback-configuration"><h3 class="title topictitle3" id="ariaid-title4">Playback Configuration</h3><div class="body"><p class="p">When the user enters playback configuration, the app should allow them to change their audio content (playlists, books, or podcasts) within the app. The interface for playback configuration is defined by the audio content provider.</p><figure class="fig fignone">
<img class="image" src="../../resources/faq/playback_configuration.png"><br>
</figure><p class="p">This flow allows a user to control what songs to playback. The app can allow the user to choose from playlists or individual songs. The app can choose to start playback from this flow using <code class="ph codeph">Media.startPlayback()</code>, or let the user select play from the media player.</p></div></article><article class="topic nested2" aria-labelledby="ariaid-title5" id="playback-1"><h3 class="title topictitle3" id="ariaid-title5">Playback</h3><div class="body"><p class="p">Playback is driven by the media player, but the app can decide what media player controls to display and what content to play. This is enabled by defining a <code class="ph codeph">Media.ContentDelegate</code> class.</p><p class="p">The content delegate is responsible for providing a <code class="ph codeph">Media.ContentIterator</code> that provides the media player an iterator of <code class="ph codeph">Media.ContentRef</code> instances that represent the downloaded songs. The content iterator also provides a <code class="ph codeph">Media.PlaybackProfile</code> that allows customization of the media player interface. The skip buttons can be disabled on a per-song basis, and <code class="ph codeph">Media.ContentRef</code> metadata will display in the player.</p><p class="p">As audio is played, the media player sends playback information to the <code class="ph codeph">ContentDelegate</code> that can be used for reporting purposes. The Connect IQ app can store the reporting information for each play of a song and send it back to the provider via web calls, or during sync.</p></div></article></article><article class="topic nested1" aria-labelledby="ariaid-title6" id="hints-and-tips"><h2 class="title topictitle2" id="ariaid-title6">Hints and Tips</h2><div class="body"><p class="p">The <code class="ph codeph">Toybox.Media</code> module provide tools for downloading and interfacing with audio content, but for keeping reporting information you should take advantage of the <code class="ph codeph">Toybox.Application.Storage</code> module. The Connect IQ storage system provides a simple key/value system for persisting content, but values are limited to 8KB.</p><p class="p">If you're storing lots of playback information, it is important to design an approach with these limits in mind. It's best to use a flat structure, as nested tables will quickly grow past your 8 KB limit.</p><figure class="fig fignone">
<img class="image" src="../../resources/faq/music_storage.png"><br>
</figure><p class="p">Store playlist ids (<code class="ph codeph">Px</code>) in a top-level array using a known key ("playlists"). Give each playlist and song id (<code class="ph codeph">Sx</code>) their own dictionary entry in Storage. In playlists store the song id references, and in song ids store the <code class="ph codeph">ContentRef</code> id and an array of plays. This allows each song to use most of the storage for song playback storage.</p></div></article><article class="topic nested1" aria-labelledby="ariaid-title7" id="conclusion"><h2 class="title topictitle2" id="ariaid-title7">Conclusion</h2><div class="body"><p class="p">With Connect IQ audio content provide apps you can:</p><ul class="ul"><li class="li"><p class="p">Deliver your protected content securely to Garmin music-enabled wearables via your existing content delivery web services</p></li><li class="li"><p class="p">Provide your users the ability to listen to their favorite content from your service while leaving their phone behind</p></li><li class="li"><p class="p">Provide an experience that integrates seamlessly with the native watch user interface</p></li><li class="li"><p class="p">Maintain accurate royalty calculations by caching playback information in encrypted app storage to send to your reporting services via the web during sync</p></li></ul></div></article></article></main><footer role="contentinfo"><div>
<p class="disclaimer">
Connect IQ System None API 8.2.3 Documentation. Copyright 2025 Garmin International. All Rights Reserved.
</p>
</div></footer></body></html>